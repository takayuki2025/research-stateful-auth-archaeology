{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/sell/W-Item-Sell.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"actions\": \"W-Item-Sell-module__J-3MDa__actions\",\n  \"categoryActive\": \"W-Item-Sell-module__J-3MDa__categoryActive\",\n  \"categoryButton\": \"W-Item-Sell-module__J-3MDa__categoryButton\",\n  \"categoryButtons\": \"W-Item-Sell-module__J-3MDa__categoryButtons\",\n  \"centerTitle\": \"W-Item-Sell-module__J-3MDa__centerTitle\",\n  \"error\": \"W-Item-Sell-module__J-3MDa__error\",\n  \"form\": \"W-Item-Sell-module__J-3MDa__form\",\n  \"formGroup\": \"W-Item-Sell-module__J-3MDa__formGroup\",\n  \"hint\": \"W-Item-Sell-module__J-3MDa__hint\",\n  \"imageBox\": \"W-Item-Sell-module__J-3MDa__imageBox\",\n  \"imageBoxWide\": \"W-Item-Sell-module__J-3MDa__imageBoxWide\",\n  \"imageButton\": \"W-Item-Sell-module__J-3MDa__imageButton\",\n  \"imageInner\": \"W-Item-Sell-module__J-3MDa__imageInner\",\n  \"imagePlaceholder\": \"W-Item-Sell-module__J-3MDa__imagePlaceholder\",\n  \"preview\": \"W-Item-Sell-module__J-3MDa__preview\",\n  \"title\": \"W-Item-Sell-module__J-3MDa__title\",\n  \"wrapper\": \"W-Item-Sell-module__J-3MDa__wrapper\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/sell/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\n\nimport { useAuth } from \"@/ui/auth/useAuth\";\nimport styles from \"./W-Item-Sell.module.css\";\n\n/* =========================\n   Types\n========================= */\ntype SellForm = {\n  name: string;\n  price: string;\n  explain: string;\n  attributes: string;\n  categories: string[];\n};\n\ntype ItemOrigin = \"USER_PERSONAL\" | \"SHOP_MANAGED\";\n\n/* =========================\n   Constants\n========================= */\nconst CATEGORY_LIST = [\n  \"ファッション\",\n  \"家電\",\n  \"インテリア\",\n  \"レディース\",\n  \"メンズ\",\n  \"コスメ\",\n  \"本\",\n  \"ゲーム\",\n  \"スポーツ\",\n  \"キッチン\",\n  \"ハンドメイド\",\n  \"アクセサリー\",\n];\n\n/* =========================\n   Page\n========================= */\nexport default function ItemSellPage() {\n  const router = useRouter();\n  const { isAuthenticated, isLoading, apiClient, user } = useAuth();\n\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\n\n  /* =========================\n     State\n  ========================= */\n  const [form, setForm] = useState<SellForm>({\n    name: \"\",\n    price: \"\",\n    explain: \"\",\n    attributes: \"\",\n    categories: [],\n  });\n\n  const [itemOrigin, setItemOrigin] = useState<ItemOrigin>(\"USER_PERSONAL\");\n\n  const [selectedShopId, setSelectedShopId] = useState<number | null>(null);\n\n  const [imageFile, setImageFile] = useState<File | null>(null);\n\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const [error, setError] = useState(\"\");\n\n  /* =========================\n     Auth Guard\n  ========================= */\n  useEffect(() => {\n    if (!isLoading && !isAuthenticated) {\n      router.replace(\"/login\");\n    }\n  }, [isLoading, isAuthenticated, router]);\n\n  /* =========================\n     SHOP_MANAGED 初期化\n     SoT: primary_shop\n  ========================= */\n  useEffect(() => {\n    if (!user) return;\n\n    if (itemOrigin === \"SHOP_MANAGED\") {\n      setSelectedShopId(user.primary_shop?.shop_id ?? null);\n    } else {\n      setSelectedShopId(null);\n    }\n  }, [itemOrigin, user]);\n\n  if (isLoading || !user) return null;\n\n  /* =========================\n     Image Select\n  ========================= */\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setImageFile(file);\n    setPreviewUrl(URL.createObjectURL(file));\n  };\n\n  /* =========================\n     Category Toggle\n  ========================= */\n  const toggleCategory = (category: string) => {\n    setForm((prev) => ({\n      ...prev,\n      categories: prev.categories.includes(category)\n        ? prev.categories.filter((c) => c !== category)\n        : [...prev.categories, category],\n    }));\n  };\n\n  /* =========================\n     Submit（DDD 正式フロー）\n  ========================= */\n  const submitItem = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!apiClient || !user) {\n      setError(\"ログイン状態が確認できません\");\n      return;\n    }\n\n    if (!imageFile) {\n      setError(\"画像を選択してください\");\n      return;\n    }\n\n    if (itemOrigin === \"SHOP_MANAGED\" && !selectedShopId) {\n      setError(\"出品するショップを選択してください\");\n      return;\n    }\n\n    setIsSubmitting(true);\n    setError(\"\");\n\n    try {\n      /* =========================\n         1. Draft 作成\n      ========================= */\n      const draftRes = await apiClient.post(\"/items/drafts\", {\n        seller_id:\n          itemOrigin === \"USER_PERSONAL\"\n            ? `individual:${user.id}`\n            : \"shop:managed\",\n        name: form.name,\n        price_amount: Number(form.price),\n        price_currency: \"JPY\",\n        brand: form.attributes || null,\n        explain: form.explain || null,\n        category: form.categories.length ? form.categories : null,\n      });\n\n      const draftId: string = draftRes.data.draft_id;\n\n      /* =========================\n         2. Image Upload\n      ========================= */\n      const imageData = new FormData();\n      imageData.append(\"image\", imageFile);\n\n      await apiClient.post(`/items/drafts/${draftId}/image`, imageData, {\n        headers: { \"Content-Type\": \"multipart/form-data\" },\n      });\n\n      /* =========================\n         3. Publish\n         ★ shop_id だけ送るのが正解\n      ========================= */\n      await apiClient.post(`/items/drafts/${draftId}/publish`, {\n        shop_id: itemOrigin === \"SHOP_MANAGED\" ? selectedShopId : null,\n      });\n\n      router.push(\"/\");\n    } catch {\n      setError(\"商品の出品に失敗しました\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  /* =========================\n     UI（初期デザイン完全保持）\n  ========================= */\n  return (\n    <div className={styles.wrapper}>\n      <h2 className={`${styles.title} ${styles.centerTitle}`}>商品の出品</h2>\n\n      <form onSubmit={submitItem} className={styles.form}>\n        {/* 出品名義 */}\n        <div className={styles.formGroup}>\n          <label>出品名義</label>\n          <div className={styles.radioGroup}>\n            <label>\n              <input\n                type=\"radio\"\n                checked={itemOrigin === \"USER_PERSONAL\"}\n                onChange={() => setItemOrigin(\"USER_PERSONAL\")}\n              />\n              個人出品\n            </label>\n\n            <label>\n              <input\n                type=\"radio\"\n                checked={itemOrigin === \"SHOP_MANAGED\"}\n                onChange={() => setItemOrigin(\"SHOP_MANAGED\")}\n              />\n              ショップ管理商品\n            </label>\n          </div>\n        </div>\n\n        {/* ショップ選択 */}\n        {itemOrigin === \"SHOP_MANAGED\" && (\n          <div className={styles.formGroup}>\n            <label>出品するショップ</label>\n            <select\n              value={selectedShopId ?? \"\"}\n              onChange={(e) => setSelectedShopId(Number(e.target.value))}\n              required\n            >\n              <option value=\"\">選択してください</option>\n              {user.shop_roles.map((r) => (\n                <option key={r.shop_id} value={r.shop_id}>\n                  ショップID #{r.shop_id}\n                </option>\n              ))}\n            </select>\n          </div>\n        )}\n\n        {/* 画像 */}\n        <div className={styles.imageBoxWide}>\n          <div className={styles.imageInner}>\n            {previewUrl && <img src={previewUrl} className={styles.preview} />}\n\n            <button\n              type=\"button\"\n              className={styles.imageButton}\n              onClick={() => fileInputRef.current?.click()}\n            >\n              画像を選択する\n            </button>\n          </div>\n\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\"image/*\"\n            hidden\n            onChange={handleImageChange}\n          />\n        </div>\n\n        {/* カテゴリー */}\n        <div className={styles.formGroup}>\n          <label>カテゴリー（複数選択）</label>\n          <div className={styles.categoryButtons}>\n            {CATEGORY_LIST.map((cat) => (\n              <button\n                key={cat}\n                type=\"button\"\n                className={\n                  form.categories.includes(cat)\n                    ? styles.categoryActive\n                    : styles.categoryButton\n                }\n                onClick={() => toggleCategory(cat)}\n              >\n                {cat}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* brand / condition / color */}\n        <div className={styles.formGroup}>\n          <label>\n            ブランド・状態・色（まとめて入力可能でどのような複雑なデーターでも処理できる開発をしています。）\n          </label>\n          <input\n            type=\"text\"\n            placeholder=\"例：Apple ほぼ新品 黒（スペース、コンマなど有無でも可能）\"\n            value={form.attributes}\n            onChange={(e) =>\n              setForm((v) => ({\n                ...v,\n                attributes: e.target.value,\n              }))\n            }\n          />\n          <small className={styles.hint}>\n            ※ 入力内容は自動で解析・正規化されます\n            ※企業判断や成長企画や実績に未来再利用可能な形で蓄積するエンジン開発のプロトタイプです。\n          </small>\n        </div>\n\n        {/* 商品名 */}\n        <div className={styles.formGroup}>\n          <label>商品名</label>\n          <input\n            type=\"text\"\n            value={form.name}\n            onChange={(e) =>\n              setForm((v) => ({\n                ...v,\n                name: e.target.value,\n              }))\n            }\n            required\n          />\n        </div>\n\n        {/* 商品説明 */}\n        <div className={styles.formGroup}>\n          <label>商品説明</label>\n          <textarea\n            rows={6}\n            value={form.explain}\n            onChange={(e) =>\n              setForm((v) => ({\n                ...v,\n                explain: e.target.value,\n              }))\n            }\n          />\n        </div>\n\n        {/* 価格 */}\n        <div className={styles.formGroup}>\n          <label>価格</label>\n          <input\n            type=\"number\"\n            placeholder=\"¥\"\n            value={form.price}\n            onChange={(e) =>\n              setForm((v) => ({\n                ...v,\n                price: e.target.value,\n              }))\n            }\n            required\n          />\n        </div>\n\n        {error && <p className={styles.error}>{error}</p>}\n\n        <div className={styles.actions}>\n          <button type=\"submit\" disabled={isSubmitting}>\n            出品する\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}