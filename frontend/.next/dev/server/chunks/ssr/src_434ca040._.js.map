{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/src/utils/utils.ts"],"sourcesContent":["// ======================================\n// IMAGE TYPE（fallback 用）\n// ======================================\nexport enum IMAGE_TYPE {\n  USER = \"user\",\n  ITEM = \"item\",\n  OTHER = \"other\",\n}\n\n// ======================================\n// Backend Base URL\n// ======================================\nconst BACKEND_BASE_URL =\n  process.env.NEXT_PUBLIC_BACKEND_URL ?? \"https://localhost\";\n\n// ======================================\n// Fallback Images（実在パス）\n// ======================================\nconst DEFAULT_USER_IMAGE = `${BACKEND_BASE_URL}/pictures_user/default-profile2.jpg`;\n\nconst DEFAULT_ITEM_IMAGE = `${BACKEND_BASE_URL}/storage/pictures/no-image.png`;\n\n// ======================================\n// getImageUrl（Laravel 実態対応版）\n// ======================================\nexport function getImageUrl(\n  path?: string | null,\n  type: IMAGE_TYPE = IMAGE_TYPE.OTHER,\n): string {\n  if (!path) {\n    return type === IMAGE_TYPE.USER ? DEFAULT_USER_IMAGE : DEFAULT_ITEM_IMAGE;\n  }\n\n  if (path.startsWith(\"http://\") || path.startsWith(\"https://\")) {\n    return path;\n  }\n\n  if (path.startsWith(\"/storage/\")) {\n    return `${BACKEND_BASE_URL}${path}`;\n  }\n\n  if (\n    path.startsWith(\"pictures_user/\") ||\n    path.startsWith(\"item_images/\") ||\n    path.startsWith(\"pictures/\")\n  ) {\n    return `${BACKEND_BASE_URL}/storage/${path}`;\n  }\n\n  return `${BACKEND_BASE_URL}/${path}`;\n}\n\n// ======================================\n// onImageError（型安全）\n// ======================================\nexport const onImageError: React.ReactEventHandler<HTMLImageElement> = (e) => {\n  const img = e.currentTarget;\n  img.onerror = null;\n  img.src = \"https://placehold.co/300x300?text=No+Image\";\n};\n"],"names":[],"mappings":"AAAA,yCAAyC;AACzC,yBAAyB;AACzB,yCAAyC;;;;;;;;;AAClC,IAAA,AAAK,oCAAA;;;;WAAA;;AAMZ,yCAAyC;AACzC,mBAAmB;AACnB,yCAAyC;AACzC,MAAM,mBACJ,QAAQ,GAAG,CAAC,uBAAuB,IAAI;AAEzC,yCAAyC;AACzC,wBAAwB;AACxB,yCAAyC;AACzC,MAAM,qBAAqB,GAAG,iBAAiB,mCAAmC,CAAC;AAEnF,MAAM,qBAAqB,GAAG,iBAAiB,8BAA8B,CAAC;AAKvE,SAAS,YACd,IAAoB,EACpB,cAAmC;IAEnC,IAAI,CAAC,MAAM;QACT,OAAO,kBAA2B,qBAAqB;IACzD;IAEA,IAAI,KAAK,UAAU,CAAC,cAAc,KAAK,UAAU,CAAC,aAAa;QAC7D,OAAO;IACT;IAEA,IAAI,KAAK,UAAU,CAAC,cAAc;QAChC,OAAO,GAAG,mBAAmB,MAAM;IACrC;IAEA,IACE,KAAK,UAAU,CAAC,qBAChB,KAAK,UAAU,CAAC,mBAChB,KAAK,UAAU,CAAC,cAChB;QACA,OAAO,GAAG,iBAAiB,SAAS,EAAE,MAAM;IAC9C;IAEA,OAAO,GAAG,iBAAiB,CAAC,EAAE,MAAM;AACtC;AAKO,MAAM,eAA0D,CAAC;IACtE,MAAM,MAAM,EAAE,aAAa;IAC3B,IAAI,OAAO,GAAG;IACd,IAAI,GAAG,GAAG;AACZ","debugId":null}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/mypage/W-Mypage.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"active_tab\": \"W-Mypage-module__8da8fG__active_tab\",\n  \"alert_success\": \"W-Mypage-module__8da8fG__alert_success\",\n  \"inactive_tab\": \"W-Mypage-module__8da8fG__inactive_tab\",\n  \"item_details\": \"W-Mypage-module__8da8fG__item_details\",\n  \"items_select\": \"W-Mypage-module__8da8fG__items_select\",\n  \"items_select_all\": \"W-Mypage-module__8da8fG__items_select_all\",\n  \"profile_header\": \"W-Mypage-module__8da8fG__profile_header\",\n  \"profile_header_1\": \"W-Mypage-module__8da8fG__profile_header_1\",\n  \"profile_header_2\": \"W-Mypage-module__8da8fG__profile_header_2\",\n  \"profile_page\": \"W-Mypage-module__8da8fG__profile_page\",\n  \"user_image_css\": \"W-Mypage-module__8da8fG__user_image_css\",\n  \"user_name_large_shift\": \"W-Mypage-module__8da8fG__user_name_large_shift\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/mypage/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect, useCallback, useMemo } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport type { AxiosResponse } from \"axios\";\n\nimport { useAuth } from \"@/ui/auth/useAuth\";\nimport { getImageUrl, IMAGE_TYPE, onImageError } from \"@/utils/utils\";\nimport styles from \"./W-Mypage.module.css\";\n\n/**\n * sell: 出品商品一覧（/item/[item_id]）\n * buy : 購入商品一覧（/mypage/orders/[order_id]）\n */\n\ntype PageMode = \"sell\" | \"buy\";\n\n/**\n * ★ API から返る前提の完成形\n * - row_id: React key 用（order_id-item_id など）\n * - item_id: 商品ID\n * - order_id: 購入時のみ存在\n */\ntype MypageItem = {\n  row_id: string;\n  item_id: number;\n  name: string;\n  item_image: string | null;\n  order_id?: number | null;\n  price?: number | null;\n};\n\ntype ProfileUser = {\n  id: number;\n  display_name: string | null;\n  user_image: string | null;\n};\n\nexport default function Mypage() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n\n  const {\n    isAuthenticated,\n    isLoading: isAuthLoading,\n    apiClient,\n    logout,\n  } = useAuth();\n\n  const [user, setUser] = useState<ProfileUser | null>(null);\n  const [items, setItems] = useState<MypageItem[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // =============================\n  // page 判定\n  // =============================\n  const page: PageMode = useMemo(() => {\n    return searchParams.get(\"page\") === \"buy\" ? \"buy\" : \"sell\";\n  }, [searchParams]);\n\n  // =============================\n  // プロフィール取得\n  // =============================\n  const fetchProfile = useCallback(async () => {\n    if (!apiClient) return;\n\n    try {\n      const res: AxiosResponse<any> = await apiClient.get(\"/mypage/profile\");\n      console.log(res.data.user.display_name);\n      const data = res.data.user;\n      setUser(data);\n    } catch (e: any) {\n      if (e.response?.status === 401) {\n        await logout();\n        router.replace(\"/login\");\n      }\n    }\n  }, [apiClient, logout, router]);\n\n  // =============================\n  // 出品 / 購入商品取得\n  // =============================\n  const fetchItems = useCallback(async () => {\n    if (!apiClient) return;\n\n    setIsLoading(true);\n    try {\n      const endpoint = page === \"sell\" ? \"/mypage/sell\" : \"/mypage/bought\";\n      const res: AxiosResponse<any> = await apiClient.get(endpoint);\n      const list = (res.data?.items ?? []) as MypageItem[];\n      setItems(list);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient, page]);\n\n  // =============================\n  // 初期ロード\n  // =============================\n  useEffect(() => {\n    if (isAuthLoading) return;\n\n    if (!isAuthenticated) {\n      router.replace(\"/login\");\n      return;\n    }\n\n    fetchProfile();\n  }, [isAuthLoading, isAuthenticated, fetchProfile, router]);\n\n  useEffect(() => {\n    if (user) {\n      fetchItems();\n    }\n  }, [user, fetchItems]);\n\n  if (isAuthLoading || isLoading) {\n    return <div className=\"text-center p-10\">読み込み中...</div>;\n  }\n\n  if (!user) return null;\n\n  // =============================\n  // Render\n  // =============================\n  return (\n    <div className={styles.profile_page}>\n      {/* =============================\n          Header\n      ============================== */}\n      <div className={styles.profile_header}>\n        <div className={styles.profile_header_1}>\n          <img\n            src={getImageUrl(user.user_image, IMAGE_TYPE.USER)}\n            onError={onImageError}\n            className={styles.user_image_css}\n            alt=\"ユーザー画像\"\n          />\n\n          <h2 className={`text-2xl font-bold ${styles.user_name_large_shift}`}>\n            {user.display_name ?? \"\"}\n          </h2>\n\n          <button\n            onClick={() => router.push(\"/mypage/profile\")}\n            className=\"ml-auto px-4 py-2 border border-red-500 text-red-500 rounded\"\n          >\n            プロフィールを編集\n          </button>\n        </div>\n\n        <div className={styles.profile_header_2}>\n          <Link\n            href=\"/mypage?page=sell\"\n            className={\n              page === \"sell\" ? styles.active_tab : styles.inactive_tab\n            }\n          >\n            出品した商品\n          </Link>\n\n          <Link\n            href=\"/mypage?page=buy\"\n            className={page === \"buy\" ? styles.active_tab : styles.inactive_tab}\n          >\n            購入した商品\n          </Link>\n        </div>\n      </div>\n\n      {/* =============================\n          Items\n      ============================== */}\n      <div className={styles.items_select}>\n        {items.length === 0 ? (\n          <p className=\"text-center text-gray-500\">\n            {page === \"sell\"\n              ? \"出品した商品はありません\"\n              : \"購入した商品はありません\"}\n          </p>\n        ) : (\n          items.map((item) => (\n            <div key={item.row_id} className={styles.items_select_all}>\n              <Link\n                href={\n                  page === \"buy\" && item.order_id\n                    ? `/mypage/orders/${item.order_id}`\n                    : `/item/${item.item_id}`\n                }\n              >\n                <img\n                  src={getImageUrl(item.item_image, IMAGE_TYPE.ITEM)}\n                  onError={onImageError}\n                  alt={item.name}\n                />\n                <div>{item.name}</div>\n              </Link>\n\n              {page === \"buy\" && item.order_id && (\n                <div className=\"mt-1\">\n                  <Link\n                    href={`/mypage/orders/${item.order_id}`}\n                    className=\"text-xs text-blue-600 underline\"\n                  >\n                    配送状況を見る\n                  </Link>\n                </div>\n              )}\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}