{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/shops/%5Bshop_code%5D/dashboard/orders/%5Border_id%5D/shipment/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useParams, useRouter } from \"next/navigation\";\nimport { useEffect, useState } from \"react\";\nimport { useAuth } from \"@/ui/auth/useAuth\";\n\n/**\n * ============================\n * Types\n * ============================\n */\n\ntype ShipmentStatus = \"draft\" | \"packed\" | \"shipped\" | \"delivered\";\n\ntype Shipment = {\n  id: number | null;\n  status: ShipmentStatus | null;\n  eta: string | null;\n  deliveredAt?: string | null; // ‚òÖ ËøΩÂä†Ôºà„ÅÇ„Å£„Å¶„ÇÇ„Å™„Åè„Å¶„ÇÇOKÔºâ\n  nextAction: {\n    key: \"accept\" | \"pack\" | \"ship\";\n    label: string;\n  } | null;\n};\n  export const dynamic = \"force-dynamic\";\n/**\n * ============================\n * Page\n * ============================\n */\n\nexport default function ShopOrderShipmentPage() {\n  const { shop_code, order_id } = useParams<{\n    shop_code: string;\n    order_id: string;\n  }>();\n\n  const router = useRouter();\n  const { apiClient, isReady } = useAuth();\n\n  const [shipment, setShipment] = useState<Shipment | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isActionLoading, setIsActionLoading] = useState(false);\n\n  /**\n   * ============================\n   * Fetch\n   * ============================\n   */\n  const fetchShipment = async () => {\n    if (!apiClient) return;\n\n    setIsLoading(true);\n    try {\n      const res = await apiClient.get(\n        `/shops/${shop_code}/dashboard/orders/${order_id}/shipment`,\n      );\n\n      const raw = res.data;\n\n      setShipment({\n        id: raw.shipment_id ?? null,\n        status: raw.shipment_id ? (raw.status as ShipmentStatus) : null,\n        eta: raw.eta ?? null,\n        deliveredAt: raw.delivered_at ?? null, // ‚òÖ ËøΩÂä†\n        nextAction: raw.next_action ?? null,\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!isReady || !apiClient) return;\n    fetchShipment();\n  }, [isReady, apiClient]);\n\n  if (isLoading) return <div className=\"p-6\">Ë™≠„ÅøËæº„Åø‰∏≠...</div>;\n  if (!shipment) return <div className=\"p-6 text-red-600\">ÂèñÂæóÂ§±Êïó</div>;\n\n  const hasShipment = shipment.id !== null;\n\n  /**\n   * ============================\n   * Action\n   * ============================\n   */\n  const handleAction = async () => {\n    if (!apiClient || !shipment.nextAction) return;\n\n    setIsActionLoading(true);\n    try {\n      const action = shipment.nextAction.key;\n\n      // üîí accept „ÅØ„ÄåÊú™‰ΩúÊàê„Äç„ÅÆ„Å®„Åç„Å†„Åë\n      if (action === \"accept\" && hasShipment) {\n        return;\n      }\n\n      const url =\n        action === \"accept\"\n          ? `/shops/${shop_code}/dashboard/orders/${order_id}/shipment`\n          : `/shipments/${shipment.id}/${action}`;\n\n      await apiClient.post(url);\n      await fetchShipment();\n    } finally {\n      setIsActionLoading(false);\n    }\n  };\n\n  /**\n   * ============================\n   * Render\n   * ============================\n   */\n  return (\n    <div className=\"p-6 space-y-4\">\n      <h1 className=\"text-xl font-bold\">ÈÖçÈÄÅÁÆ°ÁêÜÔºàÊ≥®Êñá #{order_id}Ôºâ</h1>\n\n      {!hasShipment && (\n        <div className=\"text-gray-600\">„Åæ„Å†ÈÖçÈÄÅ„ÅØ‰ΩúÊàê„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ</div>\n      )}\n\n      {hasShipment && shipment.status && (\n        <div className=\"text-sm\">\n          Áä∂ÊÖãÔºö\n          <span className=\"ml-2 font-mono\">{shipment.status}</span>\n        </div>\n      )}\n\n      {shipment.eta && (\n        <div className=\"text-sm\">\n          Âà∞ÁùÄ‰∫àÂÆöÔºö<span className=\"ml-2\">{shipment.eta}</span>\n        </div>\n      )}\n\n      {/* ‚úÖ ÈÖçÈÅîÂÆå‰∫ÜË°®Á§∫ÔºàÁµÇÁ´ØÁä∂ÊÖãÔºâ */}\n      {shipment.status === \"delivered\" && (\n        <div className=\"mt-4 space-y-1 text-sm\">\n          <div className=\"font-semibold text-green-700\">ÈÖçÈÅîÂÆå‰∫Ü</div>\n\n          {shipment.deliveredAt && (\n            <div className=\"text-gray-600\">\n              ÈÖçÈÅîÂÆå‰∫ÜÊó•Ôºö\n              {new Date(shipment.deliveredAt).toLocaleString()}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* ActionÔºà„Éê„ÉÉ„ÇØ„Ç®„É≥„ÉâÂÆåÂÖ®Ê∫ñÊã†Ôºâ */}\n      {shipment.nextAction &&\n        !(shipment.nextAction.key === \"accept\" && hasShipment) && (\n          <button\n            disabled={isActionLoading}\n            onClick={handleAction}\n            className=\"px-4 py-2 border rounded bg-blue-600 text-white\"\n          >\n            {shipment.nextAction.label}\n          </button>\n        )}\n\n      <button\n        onClick={() => router.push(`/shops/${shop_code}/dashboard/orders`)}\n        className=\"text-blue-600 underline text-sm\"\n      >\n        ‚Üê Ê≥®Êñá‰∏ÄË¶ß„Å∏Êàª„Çã\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}