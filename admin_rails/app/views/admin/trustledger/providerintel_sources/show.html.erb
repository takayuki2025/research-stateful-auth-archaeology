<%= render "admin/trustledger/nav" %>

<h1>Catalog Source Detail</h1>

<% if @error %>
  <div style="padding:12px; border:1px solid #f00; margin:12px 0;">
    <strong>API Error</strong><br>
    status: <%= @error.status %><br>
    <pre style="white-space:pre-wrap;"><%= @error.body %></pre>
  </div>
<% end %>

<% if @item %>
  <div style="margin: 12px 0;">
    <a href="/admin/dashboard/trustledger/providerintel/sources">Back</a>
    <span style="margin:0 8px;">|</span>
    <a href="/admin/dashboard/trustledger/providerintel/sources/<%= @item["id"] %>/edit">Edit</a>
  </div>

  <table border="1" cellpadding="8" cellspacing="0" style="border-collapse:collapse;">
    <tr><th>ID</th><td><%= @item["id"] %></td></tr>
    <tr><th>project_id</th><td><%= @item["project_id"] %></td></tr>
    <tr><th>provider_id</th><td><%= @item["provider_id"] %></td></tr>
    <tr><th>source_type</th><td><%= @item["source_type"] %></td></tr>
    <tr><th>source_url</th><td style="max-width:720px; word-break:break-all;"><%= @item["source_url"] %></td></tr>
    <tr><th>source_url_hash</th><td style="max-width:520px; word-break:break-all;"><%= @item["source_url_hash"] %></td></tr>
    <tr><th>update_frequency</th><td><%= @item["update_frequency"] %></td></tr>
    <tr><th>status</th><td><%= @item["status"] %></td></tr>
    <tr><th>last_hash</th><td style="max-width:520px; word-break:break-all;"><%= @item["last_hash"] %></td></tr>
    <tr><th>last_fetched_at</th><td><%= @item["last_fetched_at"] %></td></tr>
    <tr><th>notes</th><td style="max-width:720px; word-break:break-all;"><%= @item["notes"] %></td></tr>
  </table>

  <div style="margin: 16px 0;">
    <form method="post" action="/admin/dashboard/trustledger/providerintel/sources/<%= @item["id"] %>/run" style="display:inline;">
      <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
      <button type="submit">Run Now</button>
    </form>
  </div>
<% else %>
  <p>Not found.</p>
  <a href="/admin/dashboard/trustledger/providerintel/sources">Back</a>
<% end %>